-			this.customGroup.addItem(new CustomIC(name, this.clone()));
-		this.customGroup = toolbar.addGroup("Custom Circuits");
-                gobj.i = logicSim.customGroup.items.indexOf(gate.type);
+             gobj.i = logicSim.customGroup.items.indexOf(gate.type);
-			this.customGroup.addItem(new CustomIC(name, this.clone()));
 		this.customGroup = toolbar.addGroup("Custom Circuits");
+			this.customGroup.addItem(new CustomIC(name, this.clone()));
-    for (var i = 0; i < logicSim.customGroup.items.length; ++i) {
-        var ic = logicSim.customGroup.items[i];
+	if (logicSim.customGroup) {
+		for (var i = 0; i < logicSim.customGroup.items.length; ++i) {
+			var ic = logicSim.customGroup.items[i];
-			this.customGroup.addItem(new CustomIC(name, logicSim.clone()));
-		this.customGroup = toolbar.addGroup("Custom Circuits");
+			this.customGroup.addItem(new CustomIC(name, logicSim.clone()));
-			this.customGroup.addItem(new CustomIC(name, logicSim.clone()));
 			this.customGroup.addItem(new CustomIC(name, this.clone()));
-			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
+			this.customGroup.addItem(new CustomIC(name, logicSim.clone()));
-			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
+			this.customGroup.addItem(new CustomIC(name, this.clone()));
 			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
 			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
 			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
-		this.customGroup = this.toolbar.addGroup("Custom Circuits");
+		this.customGroup = toolbar.addGroup("Custom Circuits");
 			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
-		this.customGroup = this.toolbar.addGroup("Custom Circuits");
+		this.customGroup = toolbar.addGroup("Custom Circuits");
+			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
+		this.customGroup = this.toolbar.addGroup("Custom Circuits");
-			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
-		this.customGroup = this.toolbar.addGroup("Custom Circuits");
+			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
+		this.customGroup = this.toolbar.addGroup("Custom Circuits");
                 gobj.i = logicSim.customGroup.items.indexOf(gate.type);
 			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
+                gobj.i = logicSim.customGroup.items.indexOf(gate.type);
-	this.customGroup = null;
+    for (var i = 0; i < logicSim.customGroup.items.length; ++i) {
+        var ic = logicSim.customGroup.items[i];
+        logicSim.customGroup.addItem(ics[i]);
+			logicSim.customGroup.addItem(new CustomIC(name, logicSim.clone()));
 	this.customGroup = null;
 		this.customGroup = this.toolbar.addGroup("Custom Circuits");
 	this.customGroup = null;
 		this.customGroup = this.toolbar.addGroup("Custom Circuits");
 		this.customGroup = this.toolbar.addGroup("Custom Circuits");
-		this.customGroup.addButton(32, "Save", function (x, y) {
+	this.customGroup = null;
+		this.customGroup = this.toolbar.addGroup("Custom Circuits");
+		this.customGroup.addButton(32, "Save", function (x, y) {
